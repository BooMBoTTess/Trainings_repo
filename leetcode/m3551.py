from typing import List

import pytest

class Solution:
    def minSwaps(self, nums: List[int]) -> int:
        cp_nums = nums.copy()
        nums_sum = [sum(list(map(int, str(el)))) for el in nums]
        sorted_sum = nums_sum.copy()
        indexes = list(range(len(nums)))
        counter = 0

        flag = True
        while flag:
            flag = False
            for i in range(len(nums)-1):
                if sorted_sum[i] == sorted_sum[i + 1]:
                    if nums[i] > nums[i+1]:
                        nums[i], nums[i + 1] = nums[i + 1], nums[i]
                        sorted_sum[i], sorted_sum[i + 1] = sorted_sum[i + 1], sorted_sum[i]
                        indexes[i], indexes[i + 1] = indexes[i + 1], indexes[i]
                        flag = True

                elif sorted_sum[i] > sorted_sum[i+1]:
                    nums[i], nums[i + 1] = nums[i + 1], nums[i]
                    sorted_sum[i], sorted_sum[i+1] = sorted_sum[i+1], sorted_sum[i]
                    indexes[i], indexes[i+1] = indexes[i+1], indexes[i]
                    flag = True

        flag = True
        while flag:
            flag = False
            for i in range(len(nums)):
                if cp_nums[i] != nums[i]:
                    tmp = nums.index(cp_nums[i])
                    cp_nums[i], cp_nums[tmp] = cp_nums[tmp], cp_nums[i]
                    indexes[i], indexes[tmp] = indexes[tmp], indexes[i]
                    counter += 1
                    flag = True

        return counter

test_data = [
[[3,1,2], 2],
[[3,1,4,2], 3],
[[37,100], 1],
[[22,14,33,7], 0],
[[18,43,34,16], 2],
[[268835996,65052660,415128775], 2],
[[277993448,416038674,616955867,539372283], 3],
[[978678783,989995084,465932830,37255967], 3],
[[173989890,14589960,960045065,593543184,82845712,659480592,282918935,187228189,926359582,927014945,92880942,846651439,53231666,594518068,155213877,1605701,240525382,88162378,567623754,771973197,687177806,901947472,245784657,363487319,588619865,849854559,169607264,634617955,223387749,517988454,456482919,785604714,252715115,146153581,156885102,348668013,195264626,812646519,185532537,475349114,464216188,382042243,604840071,744374411,890978444,731898004,358875294,320929958,941973671,821739702,184418489,666738873,406823102,505905347,665051332,356327621,927932616,145973448,182173901,981655757,566517977,858890466,76906723,951771368,344375535,162906351,632078577,695025908,456737017,466592001,100385028,443547917,408830225,485785874,688677149,253337891,965812519,217940265,84549941,811311416,40976697,244506939,851714363,571867453,23552319,33775936,274850114,545603908,612106566,828989768,778993993,978755916,492347733,413450590,390152548,787734891,67756400,419733878,902152572,408904060,314204542,606724486,247832970,905970059,586514836,141320598,452952474,16695710,253272479,267723168,346407328,178651551,539279786,708944299,981713325,939565488,249840056,817783225,232448441,548053445,299237829,159302089,420004304,301474257,494813661,874283490,837173731,517308900,897343976,730841578,8356331,491700718,326959609,21676541,908812799,509460994,983613958,820797964,270688787,624984596,299926038,918995481,663175708,13836832,543228451,244367908,373146147,870007334,623600169,252174895,620053039,873726518,874627640,600744507,842138179,111755844,498287175,797016648,444383818,952148561,469566034,245310037,524567130,600113756,518988382,522879586,50750051,623977060,288105067,601277037,739394158,902824559,311247471,454107761,49685108,562299516,676962942,465134212,255648389,92947080,179200653,545849998,861299343,165339794,960520850,253395619,742752935,628998827,472220332,936755885,401900208,380117682,195969720,513196738,656188098,687448773,296108742,309674697,961856205,371507920,220676817,607453908,548078292,693633749,109535968,180052709,172892907,888087276,445612784,535519987,937165558,590496503,722174721,229032707,830784260,321962757,830432006,621159172,153912094,71508772,748389158,447521579,353485616,696206129,972727090,201728824,932766520,795337531,903897918,714736448,962765637,181224274,117932886,574178135,562193243,53429086,708330335,684122979,193250150,999179115,258679663,700867443,909656947,980042615,594436989,663815039,310313855,420365187,331391876,305660804,326017924,644383624,561341320,354206608,494265233,987579284,767017879,419185567,904119206,425100199,262177720,158991290,273277883,176153535,140035012,187679690,184312779,373990347,971473872,753861585,746767321,751387614,157893602,629687272,155001833,345490417,932717561,396452858,55788550,388867081,584934413,199050256,552461330,755868693,732324891,305144860,782468128,132965417,510002220,952296493,775824449,823288898,547234883,925262914,946422856,51373129,204022860,991847500,386507855,434111568,371156053,55329879,688096356,451159147,805610607,744711292,540681343,478110848,659088512,545072256,168739974,519611526,60548233,292275338,798008462,5678222,983811220,666551447,692946079,577463456,509944995,122389669,526255271,844874928,443794611,971834548,544982197,280634549,918103221,887260346,761390269,562431168,286991557,457254087,676463816,596772039,138667213,486827217,381273298,896361685,565191893,690676951,642114781,433579232,700318948,917972196,877749478,596853991,671089895,469828843,361571567,55190770,881526006,790824187,762111232,686753042,593511702,490497303,276784406,649381145,549430554,870884633,961930526,839460131,7152932,626541859,897795364,599205157,390645035,439969073,585188662,763495739,700433729,326755656,693855571,357721427,142665044,38634844,786974048,55240047,319178102,576251259,717972863,652871039,887498112,992093569,199697796,184894862,97748370,253117843,218203546,762029473,163825058,755017125,392086953,841057707,254797231,150300080,558949810,654509492,85951924,58492342,877266364,538314180,414549449,157124042,511649230,115443153,858662355,353248723,455738837,528360919,403883483,99806,395675104,831309281,104924642,320177637,608396779,986523117,98207214,717743600,598058483,914556403,124413427,677651956,19842551,886187508,449144315,21308924,228959744,856679941,989570565,476284427,659834382,991995414,885040663,388834838,531326491,242066972,257287709,113501730,389572132,62662184,601859626,292931114,17614387,737248820,961955381,388580920,628975161,596313659,143443525,45205064,327550539,534865493,260204118,776701526,812918362,860931682,230516328,635913836,674678382,334407280,887023216,554255987,968361592,102966907,730351230,327222913,817374849,147736198,150472326,519825039,235488916,615098014,936797861,547661484,585598641,703538865,881632945,887596735,31835842,256820933,299714250,589686478,520947407,335996627,313304791,744474331,913237727,553518819,557860583,559204073,74999533,76031727,442427121,854451955,222152441,608855807,902661894,494634760,849979148,654198541,528303889,492635925,730531606,245868312,340436769,380962593,152217388,442156846,768247598,402073394,445278004,705341238,896575287,253978427,380036924,359966525,974653248,7186240,620160832,364332867,838297411,681731907,124905286,306177859,363652935,736642888,250832711,880150350,482043728,369518416,920323927,88737625,182626149,992733029,560162668,709461868,923887479,355608446,500828030,939820928,564250497,146712454,640812934,203310982,814491530,702171020,276285341,217876382,401942431,745932714,965380011,87361453,564676535,457992124,390866881,35112897,924706756,811698118,412100551,244271050,820766667,527206348,824248282,687425501,724707295,957622240,178489313,884041698,417859559,570869742,290531317,591611895,136382461,740337662,224454658,910297094,884967435,284444693,966445084,110012445,277678111,807553056,163645471,239904801,446179365,848455718,33728550,67176487,558884905,332941356,419014701,536553519,175867953,707790897,439003187,110553150,144443455,199641150,923052101,636381254,439461962,587024460,91547724,22374478,102574164,639838297,748038244,17156196,283682920,54298729,553355381,95864957,202918013,106686598,841640071,976685192,211175565,820430993,540764312,870320296,320071850,150653100,54905009,40814770,166856889,884566204,488048834,41175237,421308620,77678799,627828946,440453334,889333984,625625312,167921892,250489068,900597998,615336176,413378800,53594362,560392453,655444231,474695944,704014601,743966987,746948882,290638099,284920082,443083030,729835806,433850662,696191271,179620134,337398060,755599669,537602360,455149881,930122042,533637435,757860677,785049928,809978187,533424461,465242448,415770961,177867099,795535708,925772126,655190368,232458592,887564640,701966691,261695844,278112611,335473003,986360172,187648366,339200368,98273649,652495216,468183414,78121339,915728765,719473023,762448256,867838336,801745284,750299529,785475982,761637264,391580051,173558166,790849943,476711325,528681379,291514789,445303205,748439978,968198574,748931504,273246646,45738423,32352700,177834429,263694784,894503363,319932870,257419722,693963213,98249170,599173592,688925148,113117663,88762848,215591393,950864367,157354480,832858614,98036214,422824451,595544580,521177604,266258947,250038791,516360715,582355473,334014997,655665692,425986592,326060577,901524022,532916795,387385919,432908873,68233802,402213456,24947282,760154711,507374175,234482278,933005926,762579566,615221881,113543815,944302730,837839499,661817995,387631769,944761498,214452891,520456863,733817503,763521699,877341349,765856422,102533804,977087162,92973755,475351742,995723971,452307659,614107863,409619160,463612634,885615325,267348703,802958051,690907875,103344877,848325361,432466674,585665269,483478265,916040443,309349117,678660869,254389010,126642964,752282388,349063962,306776864,660376353,128502563,288230180,471984941,786926382,69217070,507112240,850266929,510777,817335100,142748476,138046275,736602950,33950534,491744080,677735259,154004317,467913570,621775724,481184622,530901877,709094269,406522750,271854461,604392321,579554189,243231632,612076436,940575642,244796325,902253478,216157095,494308264,176925609,951307178,793963437,644828082,890694594,137120707,245001156,112552908,93113302,271838186,109784047,710577139,477670390,604408823,93285374,829041663,712453129,276761612,58067992,319015961,288730141,820046878,4967456,888949800,289205297,398158898,859819060,913411132,588082241,340487236,683953228,284511311,580439120,829172820,65743959,78269528,873024610,648662114,771828837,217869414,437242983,51481707,700443773,727665790,1977469,660024469,940453015,767397016,684838041,3951769,415976603,559959198,770296991,73837726,477031582,943565988,10267818,611110062,423070903,848465081,469879999,343780545,914246851,602000580,620899527,675400904,436448459,329002188,219139277,246901966,413682898,669674707,919211226,765365470,100494560,855518432,759712992,774810848,831081704,84126956,607571186,744434933,927108348,788024575,775957760,957148418,343559439,460008721,842640657,39783698,461393175,273870115,548187428,229723429,690031912,939519272,101707048,275336492,330337581,793292083,92826933,256511292,404794684,689982790,555076934,691211595,672329047,229469531,80817502,640331104,235023722,637799787,178408814,890531183,413764982,799092089,392744313,827116923,565849467,669715837,196595069,996420992,814165385,716139916,598977932,242085260,456945045,225987990,41110949,685395366,145468838,995978666,699387308,662097338,409644475,32402877,660164031,125218243,888688079,343469532,553717218,766053859,159419876,376688109,955846129,842264049,198585844,764956161,631123465,166874635,674246159,106221073,98446870,637546012,310119964,552046111,312602143,922848801,965873188,775474725,216288818,890744391,534031957,29486682,355626587,77925983,736177762,827493993,158723693,698248814,298897011,280817268,362606197,988204666,877112956,241290881,711184003,714051206,985902727,609619593,732720780,753667731,211005078,898068121,951479962,482365082,928992940,4755125,67399358,711814853,430509765,613568205,57487057,786910931,527707864,236326618,970247899,667799263,824020703,599936738,161312488,919957224,801820395,904204017,6680316,873934591,827272968,843222796,997904148,226250525,426258207,917983008,481783592,898821930,86912816,623693621,155316021,284872505,366145337,798969659,784297788,193941309,246337347,924274503,720875338,574811979,745860944,930180945,709144402,285044561,940379985,643805017,960171867,925863773,67030881,66637666,607285097,436293485,677916527,395169657,440471418,542207869,438570878,823988095,145534853,698339206,306958214,774770569,341487503,517934995,809480086,501772183,758493080,881782682,157265819,769994656,859025313,146681761,773664673,605810596,90369959,896200616,771551146,37040043,801845163,316231596,223285170,887918523,857829322,79032271,58372048,861638608,905064406,624644057,632721376,132984805,98217959,26079209,339578857,577736681,13594620,138506243,510832643,310398981,347811850,134901771,530018323,291303444,991539229,645746718,939782175,871084067,342208555,734162987,941404203,357543982,92868663,288436285,820211773,847114301,58527809,925093955,903680068,669732933,243134535,122761287,873459787,479375437,175763540,636940379,528044126,880037986,130363492,803033198,741838966,206811259,914780286,719417471,690909312,899420289,250581124,513577103,18215057,318804118,319672479,611012769,207122596,722653364,644714678,58732728,340021441,824496329,946999504,767996113,790876371,26341602,613363939,403615970,709251301,272666858,24408303,556749040,799437041,631279858,371020015,679612660,752726262,226652409,909086973,391467263,458125574,224022794,598176017,28545309,702239006,569307421,478736674,268742948,222458151,761245996,592490800,229577009,847466801,849154352,419164469,554905916,299094335,247959876,887976262,982454599,956109129,695841103,819999070,870093155,904810852,516256102,196907377,768078195,97939833,130961787,191041915,87290245,479613318,320270736,713183633,775188888,789303706,173920666,446362016,527069603,875180457,854634924,89829807,622293432,427209154,952619464,407515592,241840590,468570585,295473628,260796892,654397921,122892775,271421933,170217967,76976625,948752884,725168631,805425656,56726013,511906306,851694085,134173196,371274253,843297301,851948059,102781469,617222685,634712606,7123488,268423720,871617067,314520113,427160115,948245048,234951227,518099515,91312701,4076096,460943937,549179972,768946757,692064836,685748810,106566219,236139084,91820622,628273743,990581334,193974871,659083865,832328282,762122844,570634845,26907242,694465133,688157296,907965055,203584127,232747652,902320773,481653382,538432140,703296143,186577553,772674196,782897815,816321187,27841188,492565161,130495145,43791019,493679286,316543670,63238843,1741505,148681409,957739715,487527113,300544714,807441099,142922446,162124501,122213077,457593562,717877991,706720488,625922795,123654892,130437867,386183916,180916976,756273906,453096190,401658623,272265983,97178381,434909966,972632849,54072084,356143894,792056603,79868699,638128925,785027870,689697567,782168862,613413662,715207459,482587428,968037156,158757675,401429296,853300037,937513798,363361093,72053575,557798216,966800198,841585481,260182857,420295498,835531598,280212315,314397532,263344993,793744229,13136746,655586156,603935600,835761014,935129975,459666298,380121983,109147009,190075778,293163908,122827652,372167558,72315783,616452998,339129221,750539653,832803730,278688659,61002644,999969684,775386007,364696481,161936295,362894258,461181879,709088184,261133242,953758657,141456324,845845445,14799817,641553354,96465866,289805266,12784596,237663189,380974042,643224542,844608481,70521829,659420141,592933874,48886772,299856887,61903866,409138171,908710908,227480578,359519238,149910541,330806294,567464984,419689497,769864728,775853089,690435108,450991140,371119141,256652335,906794032,116749362,966931518,183497791,106026046,394638398,747066435,280343620,374731845,394892360,4707401,883545164,158217295,205354064,90469457,921171023,709268563,578557011,433689688,324727897,836400217,694252637,199267428,311604324,809170023,554439790,701019248,139719798,690885759,898684032,765293697,57291908,583414917,236278916,670676100,607753354,574583948,393786512,46937234,10376341,667382935,292279447,322303135,895685795,671577254,525759659,235869356,676033713,298489014,736007357,199292102,801191112,591967439,149763282,164934868,557536476,496588001,309171430,637162728,452228329,996357353,994710763,295884011,314676463,367072498,572593399,229094648,678294777,298480892,884430079,783299850,523932940,724981009,685683990,41874726,962860327,137745704,572953900,822875438,913356089,303805753,962188615,649950542,96564558,207754575,575862097,326669650,686167376,821564757,710071640,786183514,416601437,845616484,952546664,810464626,127260019,601978229,248059260,181056893,408442238,77157761,530617736,190289292,178845074,280237464,97809820,917378460,200619422,192091556,848852390,619148720,764450224,880563648,998258114,828929492,454170072,147797464,379999711,606442976,661050849,435156453,159094249,890000875,105928175,620910064,661747185,101512690,901404148,627062260,986256890,694670843,556307962,19289597,187840002,83080712,542365193,652015113,829101578,525301264,500610578,780195357,767514142,776705566,794015268,205272615,666916394,354629163,566130228,274634292,240268868,179746376,325719631,840955471,534304337,914650707,328013397,237819478,459241047,766834261,125310557,625940063,21960287,923293282,758167142,571405928,325834344,625374826,694130286,509613680,348419697,251532924,831501949,341251711,192091775,786405001,280401560,785340058,13907619,384472740,137369254,339957417,224753325,684947120,703010483,964949683,587683507,811775670,736155321,977475258,675747519,590288576,317814464,823654082,262305478,727463630,326244061,397481702,472168167,717567720,153597673,820098801,392550130,715233013,873567992,819541760,308246276,40171269,132675349,407721750,93935382,517183258,984078108,533083934,545748771,919385898,735819563,264697652,360306486,485660476,896431935,411473744,301086547,821638998,920844135,17192812,356022136,279844729,313677691,717084540,525588353,82130824,440817547,153212818,430323603,407590806,828290972,1988510,280934303,922613663,541472674,418199461,843405227,969988012,548419501,357234606,544724908,258865073,714291121,893163449,898611130,448378816,903280577,757462977,76126148,141555654,563673038,234280912,800765910,361969622,245864406,231012313,32683995,457545693,374839262,825587680,239564773,300161004,255809519,819632112,574846961,77756403,841586677,368654328,507885561,930625535,560257030,819664910,196778000,168474640,36280338,812808211,146233365,461985814,85137432,128038938,231348251,259807261,536279070,259667998,124475428,749500462,833173553,667793458,772479031,502421560,48928826,528128059,299743292,368072764,572201022,72562754,825808963,99776581,165918798,715790415,72079443,715855958,82712672,249649250,112097379,271300710,463763564,721737836,649713778,497776757,614103161,809064569,784996476,856471681,30431361,947214467,145651843,516487303,460142728,914864268,482244752,201971858,509687954,3332246,941291671,279615647,464812195,272832677,938154161,173390009,619026631,475609288,830093515,790042827,194402510,263813340,500447453,989763809,445618407,340654319,462846194,696834299,288504068,405223690,689879307,680925453,372242705,142285074,936188177,566327571,940095767,529471769,113039642,795146530,788093227,68966700,845633837,174168367,805058863,233691441,496974134,171342136,266230074,540694842,618232124,925890877,825915709,282745153,878827842,764352838,569432399,183474511,943823186,462117206,129866074,684177763,740964713,407419249,724932978,33692020,242915702,918657402,272464253,959846783,958077313,9574786,211147143,242997654,872200600,365148571,947124640,29677984,613284264,457783722,491444653,632297901,425023919,681818549,306313655,675494331,545634756,796375493,819730885,909547977,96762315,917076429,130996690,209893844,11901398,901093847,541956576,160233956,24123884,725793262,714799606,811309564,280910339,628636168,252819976,491051530,715291147,928094729,398801422,928758288,363239959,422836766,978917919,436525605,94001708,627014193,720099897,525433406,697612864,269630048,584112741,496507495,114719342,818059886,478239344,946330227,278108794,516217468,126114439,714939026,803740308,301087382,926055070,458545825,894655138,591551142,962976431,519764655,950811311,22444722,709474995,670735031,545954489,959445695,339368639,798776005,190724805,426031817,638802634,127662795,281270992,592444121,250895069,333183715,837982952,885840616,210557673,771619563,990116589,160062190,534248182,207092474,663460606,388127489,752909058,608369418,445397770,986651404,695622415,8575760,823565071,125385500,25221919,439950111,777255717,56752939,812260140,458455852,446479152,7887665,964672304,813316919,309304122,202103615,450722624,573160264,624040777,671628105,916159310,631372626,876149591,185359204,479304551,262060904,9149294,81648496,755284852,186907509,818576248,63437691,409000828,716061573,820288390,370703239,325335944,543193992,640080784,75013010,629128085,24419224,485186456,465206170,559455137,525466535,631733172,652762036,734747574,611646390,259021757,164256704,136510401,202308552,157342665,15064017,673315794,330595285,732691416,974019545,951933917,946215903,965196767,863493094,454245353,654679023,380304372,383400956,630332415,828267522,51076108,616569874,297417753,566672409,212573214,488635423,388946976,496688160,726932518,960175143,14580780,113933359,787676209,130415666,293256241,934763575,868629562,355433531,911621185,116096065,64846916,271416390,772774989,482573392,318250065,771767390,452197482,424139884,797662318,915586159,187448436,571079803,281164927,759889025,974978179,388963465,543693962,315563151,778476698,978697378,263404707,2350245,68533414,159259813,595156147,649280693,23452854,903068855,258079931,989322430,99024063,127728831,142875839,155139264,171531458,930708690,899701973,9960664,466418905,245218522,538229979,881679585,428276962,103726316,444497133,4062445,566877424,893345017,898415866,472825083,347806971,964877563,68304123,78830861,339705106,777321747,693828893,369212705,881016098,35749161,682679593,48110891,347053358,708705583,440466740,543694135,173333816,797498687,228711753,85015881,560364876,67706199,38493528,996785499,147938653,482073949,172522857,69819753,495279471,902118769,389168500,108756345,502635903,110878081,250240386,545881474,286031243,230079889,771677590,599047583,465796514,833437092,186850727,767794599,431570349,481238448,304692662,331546048,139001283,556654021,933264837,324296136,787365324,245513677,919641554,21118421,614964704,523558372,842669544,809975275,549903855,589307387,710704638,218365439,721960450,733707784,259948041,176283155,536911380,632593941,121396759,415202848,985415203,392871467,855457331,63307327,522747458,611745346,80100937,326606412,159235663,764124771,788569701,801701497,434372218,707698299,80166543,154287760,891723410,717717146,542129835,484736684,376315564,359399094,377544374,450952886,396631740,872808125,692133566,649281216,964255429,517308105,99065545,495353550,529170133,453467862,988921561,278953692,575184609,935476965,654573287,294059755,452656885,569204475,689544960,806215430,31768328,490282761,328023818,822820627,50044693,979435293,115228449,898916131,551550756,94691107,187768614,854990632,4644654,971628335,871956273,373849906,867786547,526827316,920133429,998539062,306454328,552967996,332078909,75226947,230178628,347627337,349208395,212696908,104243021,184696654,93699919,568360784,183025492,755580761,813883226,758136671,329514849,981729122,987856740,920018793,454066026,945340270,462659439,912531315,554606452,864886645,710426492,779771773,778113,650837891,952065924,33660804,424001425,694198161,677232532,59203489,22355880,791535530,757809069,805601201,37904307,386441154,816398281,255172555,333938638,376668113,91209682,655458269,939237350,648462310,365854706,528900085,342745082,402268155,600924156,705921021,16695294,481878015], 2210]
]

@pytest.mark.parametrize('test_input, test_output', test_data)
def test_solution(test_input, test_output):
    s = Solution()
    assert s.minSwaps(test_input) == test_output

